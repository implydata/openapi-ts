{{>header}}

import { useContext } from 'react';
import * as rq from 'react-query';
import type * as RQ from '{{{@root.reactQueryImport}}}';

import type { ApiError } from '../core/ApiError';
import type { ApiRequestOptions } from '../core/ApiRequestOptions';
{{#if imports}}
{{#each imports}}
import type { {{{this}}} } from '../models/{{{this}}}';
{{/each}}
{{/if}}
import { {{{name}}}{{{@root.postfix}}} } from '../services/{{{name}}}{{{@root.postfix}}}';

import { {{{@root.contextName}}} } from './{{{@root.contextName}}}';
{{#each operations}}
{{#if parameters}}

export interface {{{pascalCase name}}}Params {{>parametersType}};
{{/if}}

{{#equals method 'GET'}}
/**
{{#if deprecated}}
 * @deprecated
{{/if}}
{{#if summary}}
 * {{{escapeComment summary}}}
{{/if}}
{{#if description}}
 * {{{escapeComment description}}}
{{/if}}
{{#if parameters}}
 * @param parameters Request parameters
{{/if}}
 * @param options Option overrides
{{#each results}}
 * @returns {{{type}}} {{#if description}}{{{escapeComment description}}}{{/if}}
{{/each}}
 * @throws ApiError
 */
export function use{{{pascalCase name}}}<TError = ApiError>(
	{{#if parameters}}
	parameters: {{{pascalCase name}}}Params,
	{{/if}}
	options?: {
		/**
		 * Overrides for react-query
		 */
		query?: RQ.UseQueryOptions<{{>result}}, TError, {{>result}}, readonly unknown[]>
		/**
		 * Overrides for service request
		 */
		request?: ApiRequestOptions,
	},
): RQ.UseQueryResult<{{>result}}, TError> {
  const service = useContext({{{@root.contextName}}}).{{{camelCase @root.name}}};
  return rq.useQuery({
	{{#if parameters}}
	queryFn: () => service.{{{name}}}(parameters, options?.request),
	queryKey: {{{@root.name}}}{{{@root.postfix}}}.QueryKeys.{{{name}}}(parameters),
	{{else}}
	queryFn: () => service.{{{name}}}(options?.request),
	queryKey: {{{@root.name}}}{{{@root.postfix}}}.QueryKeys.{{{name}}}(),
	{{/if}}
	...options?.query,
  });
}
{{else}}
/**
{{#if deprecated}}
 * @deprecated
{{/if}}
{{#if summary}}
 * {{{escapeComment summary}}}
{{/if}}
{{#if description}}
 * {{{escapeComment description}}}
{{/if}}
 * @param options Option overrides
 * @param options.request Service request options
{{#each results}}
 * @returns {{{type}}} {{#if description}}{{{escapeComment description}}}{{/if}}
{{/each}}
 * @throws ApiError
 */
export function use{{{pascalCase name}}}<TError = ApiError, TContext = unknown>(
	options?: {
		/**
		 * Overrides for react-query mutation
		 */
		{{#if parameters}}
		mutation?: RQ.UseMutationOptions<{{>result}}, TError, {{{pascalCase name}}}Params, TContext>
		{{else}}
		mutation?: RQ.UseMutationOptions<{{>result}}, TError, void, TContext>
		{{/if}}
		/**
		 * Overrides for service request
		 */
		request?: ApiRequestOptions,
	},
{{#if parameters}}
): RQ.UseMutationResult<{{>result}}, TError, {{{pascalCase name}}}Params, TContext> {
{{else}}
): RQ.UseMutationResult<{{>result}}, TError, void, TContext> {
{{/if}}
  const service = useContext({{{@root.contextName}}}).{{{camelCase @root.name}}};
  return rq.useMutation({
	{{#if parameters}}
	mutationFn: parameters => service.{{{name}}}(parameters, options?.request),
	{{else}}
	mutationFn: () => service.{{{name}}}(options?.request),
	{{/if}}
	...options?.mutation,
  });
}
{{/equals}}
{{/each}}
